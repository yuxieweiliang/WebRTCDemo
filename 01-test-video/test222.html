<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <style>
    canvas {
      border: 1px solid red;
    }
  </style>
</head>
<body>
<canvas id="canvas" width="800" height="500">xxxx</canvas>
<script>
  const $canvas = document.querySelector('#canvas');
  const move = {x: 0, y: 0}

  $canvas.addEventListener('mousedown', function (e){
    console.log(e)
    move.x = e.clientX
    move.y = e.clientY
    $canvas.addEventListener('mousemove', mousemove, false)
  }, false)

  $canvas.addEventListener('mouseup', function (e) {
    if (isVerticalMove) {
      onMouseHandle(e)
    }
    console.log(e)
    isVerticalMove = true
    $canvas.removeEventListener('mousemove', mousemove, false)
  }, false)

  let isVerticalMove = true
  function onMouseHandle (e) {
    const xMove = Math.abs(move.x - e.clientX)
    const yMove = Math.abs(move.y - e.clientY)
    // X 轴移动距离 比 Y 轴两倍都大，证明是横向移动
    if (xMove / 2 > yMove || !isVerticalMove) {
      isVerticalMove = false
      return
    }

    if (move.y - e.clientY > 30) {
      console.log('to top')

    }
    if (move.y - e.clientY < -30) {
      console.log('to down')
    }
    console.log(e)
  }

  const mousemove = throttle(onMouseHandle, 100)

  // 截流函数：调用后在限时内执行一次，限时内再次调用，函数执行判断条件为关闭状态，函数不执行，函数执行后判断条件打开
  function throttle(func, limit) {
    let inThrottle; // 开关
    return function() {
      const args = arguments;
      const context = this;
      if (!inThrottle) {
        func.apply(context, args);
        inThrottle = true;
        setTimeout(() => {
// 定时器用来进行保证在一定时间内开关的状态
          inThrottle = false;
        }, limit);
      }
    };
  }
</script>
</body>
</html>
