<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <script src="./demux.js"></script>
  <script src="./mediaSource.js"></script>
  <script src="./stream.js"></script>
  <script src="./fmp4-generator.js"></script>
</head>
<body>
<button id="play">播放</button>
<video autoplay id="video" controls></video>
<script>
  const $play = document.querySelector('#play');
  const $video = document.querySelector('#video');
  let mseDecoder;

  console.log("mediaSource", mediaSource);
  $video.src = window.URL.createObjectURL(mediaSource);
  $video.oncanplay = function(){
    // console.log("准备就绪");
  };
  //监听播放开始
  $video.addEventListener('play', function(){
    console.log("开始播放");
  });

  //监听播放结束
  $video.addEventListener('pause', function(){
    console.log("播放暂停");
  });

  //监听播放结束
  $video.addEventListener('ended', function(){
    console.log("播放结束");
  });

  $play.addEventListener('click', () => {
    console.log('click');
    createSocketLoader();

    mseDecoder = createMediaSource();

    $video.play()
  }, false)
</script>
</body>
</html>
